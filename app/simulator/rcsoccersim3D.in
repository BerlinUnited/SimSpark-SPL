#! /bin/sh

kill_server()
{
        kill -s SIGINT $PID
        exit 0
}

if test -x ../agenttest/agenttest; then
    SIMULATOR="./rcssserver3D"
    PARAM="--ipc_force_remove $*"
    if test -x ../rcssmonitor3d/kerosin/rcssmonitor3D-kerosin; then
	MONITOR="../rcssmonitor3d/kerosin/rcssmonitor3D-kerosin" 
    else
	MONITOR="../rcssmonitor3d/lite/rcssmonitor3D-lite" 
    fi
else
    prefix=@prefix@
    exec_prefix=@exec_prefix@
    datadir=@datadir@
    pkgdatadir=${datadir}/@PACKAGE@
    SIMULATOR="${exec_prefix}/bin/rcssserver3D"
    PARAM="--ipc_force_remove --agent_db_fn ${pkgdatadir}/agentdb.list $*"
    if test -x "${exec_prefix}/bin/rcssmonitor3D-kerosin"; then
	MONITOR="${exec_prefix}/bin/rcssmonitor3D-kerosin"
    else
	MONITOR="${exec_prefix}/bin/rcssmonitor3D-lite"
    fi
fi

${SIMULATOR} ${PARAM} &
PID=$!
sleep 1
${MONITOR}
kill_server
